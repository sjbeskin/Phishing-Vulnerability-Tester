from flask import Flask, jsonify, request, redirect, render_template
from flask_cors import CORS, cross_origin
from sqlconnector import SQLConnector
import os
app = Flask(__name__)
cors = CORS(app)
app.config['CORS_HEADERS'] = 'Content-Type'

__location__ = os.path.realpath(
os.path.join(os.getcwd(), os.path.dirname(__file__)))

@app.route('/', methods=['GET'])
@cross_origin
def test():
    try:
        uuid = request.args.get('id')
        sql_conn = SQLConnector()
        sql_conn.register_recipient_scam_click(uuid)
    except ValueError:
        #No id
        print("No id")
    return redirect('https://www.google.com', code=302)

@app.route('/addrecipient', methods=['GET', 'POST'])
def add_recipient():
    if request.method == 'POST':
        if 'file' not in request.files:
            print('NO FILE')
            return redirect('https://www.google.com')
        file = request.files['file']
        print(file.filename)


    return render_template('test.html')


if __name__=='__main__':
    app.run(debug=True, port=8080)